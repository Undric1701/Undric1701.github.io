<!-- Treatykov Andrey (AT7), 10-7, 11.06.2025, Chat task -->

<!DOCTYPE html>
<html>

<head>     
    <title>AT7 chat.</title>
    <link rel="icon" type="image/x-icon" href="./logo.ico"></link>
    <style>
    h1, p1, p2 {
        text-align:center;
        color:rgb(0, 0, 0);
    }
    </style>
    <!-- <script type="text/javascript" src="./node_modules/socket.io-client/dist/socket.io.js"></script> -->
     <script src="/socket.io/socket.io.js"></script>
    <script type="module">
        import {openWebsocketCommunication, SendMessage, requestMessages} from "./client.js"                       

        let usernameInput, passwordInput;
        async function main() {  
            document.getElementById("Send-Message").onclick = function () {   
                let message = document.getElementById("Message-Input").value;
                if (message.length != 0) {
                    SendMessage(message);
                }
            }                                                                 
            document.getElementById("Message-Input").onkeypress = function (e) {
                if (e.key == 'Enter') {   
                    let message = document.getElementById("Message-Input").value;
                    if (message.length != 0) {
                        SendMessage(message);
                    }                      
                }
            }     
            await openWebsocketCommunication();  
            requestMessages();                                                                   
        }
        window.addEventListener("load", () => { main() });
    </script>
</head>

<body style="
        background-image: url('./angrybird.jpg');
        background-repeat: no-repeat;
        background-size: cover;">
    <div>
        <input type="text" id="Message-Input" style="position: absolute; top: 150px; left: 1500px; width: 400px; height: 30px; font-size: 30px; background-color: azure;"></input>                       
    <div id="Chat-Messages" style=" overflow-y: scroll; height: 750px; position: absolute; top: 100px; left:350px; font-size: 47px; max-width: 900px; width: 900px;"></div>
    <button id="Send-Message"
        style=
        "width: 400px;
        height: 47px;
        background-color:rgb(128, 179, 130);
        font-size: 30px;
        position: absolute;
        top: 200px;
        left: 1500px;">
        <strong>Send message</strong>
    </button>
    <p3 style="position: absolute; top: 410px; left: 1500px; font-size: 30px" id="Dynamic-Text"></p3>
    <p><a href = "/">back...</a></p>
    </div>              
</body>
       
</html>